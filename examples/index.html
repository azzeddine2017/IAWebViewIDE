 <!DOCTYPE html>
            <html dir="rtl" lang="ar">
            <head>
                <meta charset="UTF-8">
                <title>Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</title>
                <style>
                    body {
                        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                        margin: 0;
                        padding: 20px;
                        background: #f0f2f5;
                    }
                    .container {
                        max-width: 800px;
                        margin: 0 auto;
                        background: white;
                        border-radius: 10px;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                        padding: 20px;
                    }
                    .messages {
                        height: 400px;
                        overflow-y: auto;
                        padding: 15px;
                        border: 1px solid #ddd;
                        border-radius: 8px;
                        margin-bottom: 20px;
                        background: #fafafa;
                    }
                    .message {
                        margin: 10px 0;
                        padding: 12px;
                        border-radius: 10px;
                        max-width: 85%;
                        white-space: pre-wrap;
                    }
                    .user-message {
                        background: #0084ff;
                        color: white;
                        margin-left: auto;
                    }
                    .ai-message {
                        background: #e8f5e8;
                        margin-right: auto;
                        border-left: 4px solid #4CAF50;
                    }
                    .system-message {
                        background: #fff3cd;
                        margin: 5px auto;
                        text-align: center;
                        border-left: 4px solid #ffc107;
                        font-size: 14px;
                    }
                    .input-container {
                        display: flex;
                        gap: 10px;
                        margin-bottom: 15px;
                    }
                    input {
                        flex: 1;
                        padding: 12px;
                        border: 1px solid #ddd;
                        border-radius: 6px;
                        font-size: 16px;
                    }
                    button {
                        padding: 12px 20px;
                        background: #0084ff;
                        color: white;
                        border: none;
                        border-radius: 6px;
                        cursor: pointer;
                        font-size: 14px;
                    }
                    
                    /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±ÙŠØ¶ */
                    strong {
                        font-weight: 700;
                        color: #1d2129;
                    }

                    /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø§Ø¦Ù„ */
                    em {
                        font-style: italic;
                        color: #4b4f56;
                    }

                    /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´Ø·ÙˆØ¨ */
                    s {
                        text-decoration: line-through;
                        color: #90949c;
                    }

                    /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¶Ù…Ù† (inline code) */
                    code {
                        background-color: #f0f2f5;
                        padding: 2px 6px;
                        border-radius: 4px;
                        font-family: 'Courier New', Courier, monospace;
                        font-size: 0.9em;
                    }
                    pre {
                        background: #2d2d2d;
                        color: #f8f8f2;
                        padding: 15px;
                        border-radius: 8px;
                        border: 1px solid #444;
                        font-family: 'Courier New', Courier, monospace;
                        white-space: pre-wrap;
                        direction: ltr;
                        text-align: left;
                        overflow-x: auto;
                    }
                    button:hover {
                        background: #0073e6;
                    }
                    .test-btn {
                        background: #28a745;
                        margin-left: 10px;
                    }
                    .test-btn:hover {
                        background: #218838;
                    }
                </style>
            </head>
            <body>
                <div class="container">
                    <h1>ğŸ¤– Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h1>
                    
                    <div class="messages" id="messages">
                        <div class="message system-message">
                            Ù…Ø±Ø­Ø¨Ø§Ù‹! Ù‡Ø°Ø§ Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                        </div>
                    </div>
                    
                    <div class="input-container">
                        <input type="text" id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§..." 
                                onkeypress="if(event.key === 'Enter') sendMessage()">
                        <button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„</button>
                        <button class="test-btn" onclick="testAIConnection()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„</button>
                    </div>
                </div>

                <script>
                    async function sendMessage() {
                        const input = document.getElementById('messageInput');
                        const message = input.value.trim();
                        
                        if (!message) return;
                        
                        // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                        addMessage('ğŸ‘¤ Ø£Ù†Øª: ' + message, 'user-message');
                        input.value = '';
                        
                        try {
                            // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø¯Ø§Ù„Ø© Ring
                            console.log('Calling sendAIMessage with:', message);
                            const response = await window.sendAIMessage(message);
                            console.log('AI Response:', response);
            
                            addMessage('ğŸ¤– Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ: ' + response, 'ai-message');
                        } catch (error) {
                            console.error('Error:', error);
                            addMessage('âŒ Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£: ' + error.message, 'system-message');
                        }
                    }

                    async function testAIConnection() {
                        addMessage('ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...', 'system-message');
                        
                        try {
                            const result = await window.testConnection('test');
                            addMessage('âœ… Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ' + result, 'system-message');
                        } catch (error) {
                            addMessage('âŒ ÙØ´Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ' + error.message, 'system-message');
                        }
                    }

                    function addMessage(text, className) {
                        const messages = document.getElementById('messages');
                        const div = document.createElement('div');
                        div.className = 'message ' + className;

                        // 1. Ø§Ù„Ø£Ù…Ø§Ù†: ØªÙ‡ÙŠØ¦Ø© Ù…Ø­Ø§Ø±Ù HTML Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
                        let safeText = text.replace(/</g, "&lt;").replace(/>/g, "&gt;");

                        // 2. Ù…Ø¹Ø§Ù„Ø¬Ø© ÙƒØªÙ„ Ø§Ù„ÙƒÙˆØ¯ (```...```) Ø£ÙˆÙ„Ø§Ù‹ Ù„ØªØ­ÙŠÙŠØ¯Ù‡Ø§
                        let formattedText = safeText.replace(/```([\s\S]*?)```/g, function(match, codeContent) {
                            let originalCode = codeContent.replace(/&lt;/g, "<").replace(/&gt;/g, ">");
                            return `<pre>${originalCode.trim()}</pre>`;
                        });

                        // 3. ØªØ·Ø¨ÙŠÙ‚ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù…Ø§Ø±ÙƒØ¯Ø§ÙˆÙ† Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Øµ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
                        //    Ø§Ù„ØªØ±ØªÙŠØ¨ Ù…Ù‡Ù… Ù‡Ù†Ø§!
                        
                        // Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±ÙŠØ¶ (**text**)
                        formattedText = formattedText.replace(/\*\*([^\*]+)\*\*/g, '<strong>$1</strong>');
                        
                        // Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø§Ø¦Ù„ (*text*)
                        formattedText = formattedText.replace(/\*([^\*]+)\*/g, '<em>$1</em>');
                        
                        // Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´Ø·ÙˆØ¨ (~~text~~)
                        formattedText = formattedText.replace(/~~(.*?)~~/g, '<s>$1</s>');
                        
                        // Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…Ø¶Ù…Ù† (`code`)
                        formattedText = formattedText.replace(/`([^`]+)`/g, '<code>$1</code>');

                        // 4. Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¨Ù€ <br> ÙÙŠ Ø§Ù„Ù†Øµ Ø§Ù„Ø°ÙŠ Ù„ÙŠØ³ ÙƒÙˆØ¯Ù‹Ø§
                        formattedText = formattedText.replace(/(<pre>[\s\S]*?<\/pre>)|(\n)/g, function(match, preBlock, newline) {
                            if (preBlock) return preBlock; // Ø§ØªØ±Ùƒ ÙƒØªÙ„ Ø§Ù„ÙƒÙˆØ¯ ÙƒÙ…Ø§ Ù‡ÙŠ
                            if (newline) return '<br>';    // Ø­ÙˆÙ„ Ø§Ù„Ø£Ø³Ø·Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø¥Ù„Ù‰ <br>
                            return match;
                        });

                        div.innerHTML = formattedText;
                        messages.appendChild(div);
                        messages.scrollTop = messages.scrollHeight;
                    }
                    
                    // Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
                    window.addEventListener('load', function() {
                        console.log('Page loaded, testing functions...');
                        console.log('sendAIMessage available:', typeof window.sendAIMessage);
                        console.log('testConnection available:', typeof window.testConnection);
                    });
                </script>
            </body>
            </html>